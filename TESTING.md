# 测试指南

本文档提供了测试重构后的深空之眼 AHK 脚本的详细步骤。

## 测试环境要求

- Windows 操作系统
- AutoHotkey v1.1.x
- 深空之眼游戏（可选，用于完整测试）
- 游戏分辨率设置为 1280x720

## 测试步骤

### 1. 基础功能测试

#### 1.1 脚本启动测试

1. **双击运行** `AetherGazer.ahk`
2. **验证点**：
   - 脚本是否请求管理员权限
   - 是否在系统托盘显示脚本图标
   - 是否自动创建 `settings.ini` 文件（如不存在）

#### 1.2 配置加载测试

1. 检查 `settings.ini` 是否被正确创建
2. **验证点**：
   - 文件包含所有必需的节：`[General]`、`[Hotkeys]`、`[Dimension]`、`[Statistics]`
   - 所有默认值都已正确写入

### 2. GUI 界面测试

#### 2.1 打开设置界面

1. 右键点击托盘图标
2. 选择"打开设置"
3. **验证点**：
   - 设置窗口正常打开
   - 包含 6 个标签页
   - 界面使用 Microsoft YaHei 字体

#### 2.2 Tab 1: 通用设置

1. 测试分辨率下拉菜单
2. 测试显示状态提示复选框
3. 修改提示位置坐标
4. **验证点**：
   - 所有控件正常工作
   - 当前值正确显示

#### 2.3 Tab 2: 游戏按键

1. 修改任意游戏按键
2. 点击"保存设置"
3. 重新打开设置界面
4. **验证点**：
   - 修改已保存
   - 设置正确显示

#### 2.4 Tab 3: 脚本快捷键

1. 修改任意脚本快捷键
2. 保存并关闭设置
3. **验证点**：
   - 新快捷键立即生效（无需重启）
   - 旧快捷键不再工作

#### 2.5 Tab 4: 多维变量

1. 测试难度选择下拉菜单
2. 测试各个复选框
3. 修改最大运行次数
4. **验证点**：
   - 所有设置正确保存到 `settings.ini`

#### 2.6 Tab 5: 统计信息

1. 查看统计数据
2. 点击"重置统计数据"
3. **验证点**：
   - 统计数据正确显示
   - 重置功能正常工作

#### 2.7 Tab 6: 关于

1. 查看版本信息
2. 验证链接可点击
3. **验证点**：
   - 所有信息正确显示

### 3. 配置管理测试

#### 3.1 导出配置

1. 在 Tab 1 点击"导出配置"
2. 选择保存位置
3. **验证点**：
   - 配置文件成功导出
   - 导出的文件内容正确

#### 3.2 导入配置

1. 修改当前配置
2. 点击"导入配置"
3. 选择之前导出的文件
4. **验证点**：
   - 配置成功导入
   - 提示重启脚本

#### 3.3 备份配置

1. 点击"备份配置"
2. **验证点**：
   - 创建带时间戳的备份文件
   - 显示备份成功消息

#### 3.4 恢复默认

1. 点击"恢复默认设置"
2. 确认操作
3. **验证点**：
   - 所有设置恢复为默认值
   - `settings.ini` 被重新创建

### 4. 统计功能测试

#### 4.1 查看统计信息

1. 右键托盘图标
2. 选择"查看统计"
3. **验证点**：
   - 统计窗口正常打开
   - 显示总体统计和当前会话统计

#### 4.2 统计数据持久化

1. 使用任意战斗脚本
2. 关闭并重新打开脚本
3. 查看统计信息
4. **验证点**：
   - 统计数据正确保存
   - 重启后数据保留

### 5. 战斗脚本测试

**注意**：以下测试需要在游戏中进行

#### 5.1 金乌自动战斗

1. 进入游戏战斗
2. 按下金乌快捷键（默认：小键盘1）
3. **验证点**：
   - 显示"金乌：启动"提示
   - 自动执行战斗循环
   - 再次按下停止脚本

#### 5.2 陵光自动战斗

1. 进入游戏战斗
2. 按下陵光快捷键（默认：小键盘3）
3. **验证点**：
   - 脚本正常运行
   - 技能顺序正确

#### 5.3 其他角色测试

对以下角色重复相同的测试步骤：
- 托特/哈迪斯（小键盘4）
- 娜美（小键盘5）
- 薇儿（小键盘6）
- 梵天（Ctrl+小键盘1）
- 诗寇蒂（Ctrl+小键盘2）
- 樱切（Ctrl+小键盘3）
- 亚莉莎（Ctrl+小键盘4）

#### 5.4 多维变量自动刷分

**前置条件**：
- 游戏分辨率：1280x720
- 解锁 20 难度
- 解锁角色真红
- 解锁信标：赏金猎人、孤狼之道、残酷天平

测试步骤：
1. 进入多维变量界面
2. 按下多维变量快捷键（默认：小键盘2）
3. **验证点**：
   - 自动选择难度
   - 自动选择角色
   - 自动选择信标
   - 自动战斗
   - 完成后正确退出

### 6. 其他功能测试

#### 6.1 自动烤肉

1. 进入闲暇时刻烤肉界面
2. 按下烤肉快捷键（默认：小键盘7）
3. **验证点**：
   - 自动识别颜色
   - 正确按下对应按键

#### 6.2 简易连点器

1. 按下连点器快捷键（默认：小键盘9）
2. 在弹出窗口中设置连点按键和间隔
3. 点击确认
4. **验证点**：
   - 弹窗正常显示
   - 连点功能正常工作
   - 显示连点状态提示

#### 6.3 右 Ctrl 连点

1. 按住右 Ctrl 键
2. 按下任意键（如 J）
3. **验证点**：
   - 自动连点指定的键
   - 显示连点提示

### 7. 热键即时生效测试

1. 打开设置界面
2. 修改任意快捷键（如金乌从小键盘1改为小键盘7）
3. 保存设置
4. **不重启脚本**，直接测试新快捷键
5. **验证点**：
   - 新快捷键立即生效
   - 旧快捷键不再工作

### 8. 停止脚本测试

1. 启动任意自动战斗脚本
2. 按下停止脚本快捷键（默认：小键盘0）
3. **验证点**：
   - 所有运行中的脚本停止
   - 提示消失

### 9. 托盘菜单测试

1. 右键点击托盘图标
2. 测试所有菜单项
3. **验证点**：
   - "打开设置"正常工作
   - "查看统计"正常工作
   - "退出程序"正常工作

### 10. 向后兼容性测试

1. 如果存在旧版本的 `settings.ini`，重命名为 `settings_old.ini`
2. 将 `settings_old.ini` 复制为 `settings.ini`
3. 启动脚本
4. **验证点**：
   - 脚本正常加载旧配置
   - 自动补充缺失的新配置项
   - 所有旧配置值保留

## 常见问题排查

### 脚本无法启动

- 检查是否授予了管理员权限
- 检查 AutoHotkey 版本是否正确（需要 v1.1.x）
- 检查 `lib` 目录是否完整

### 热键不工作

- 检查是否在游戏窗口激活状态
- 检查快捷键是否与其他程序冲突
- 查看 `settings.ini` 中的按键设置是否正确

### GUI 界面显示异常

- 检查系统是否安装了 Microsoft YaHei 字体
- 检查显示缩放是否为 100%

### 多维变量不工作

- 确认游戏分辨率为 1280x720
- 确认已解锁所需角色和信标
- 检查 FindText 图像识别是否正常

## 测试报告模板

### 测试环境

- 操作系统：Windows XX
- AutoHotkey 版本：
- 游戏版本：
- 测试日期：

### 测试结果

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 脚本启动 | ✓/✗ | |
| 配置加载 | ✓/✗ | |
| GUI 界面 | ✓/✗ | |
| 配置管理 | ✓/✗ | |
| 统计功能 | ✓/✗ | |
| 战斗脚本 | ✓/✗ | |
| 其他功能 | ✓/✗ | |
| 热键即时生效 | ✓/✗ | |

### 发现的问题

1. 问题描述
   - 重现步骤
   - 预期结果
   - 实际结果

### 建议改进

1. 改进建议描述
